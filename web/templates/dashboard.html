{% extends "base.html" %}

{% block title %}Dashboard - Sistema Guardião BETA{% endblock %}

{% block main_class %}dashboard-page{% endblock %}

{% block extra_head %}
<style>
    .dashboard-page {
        background: var(--dark-bg);
        min-height: 100vh;
        padding-top: 2rem;
    }

    /* Glass morphism cards */
    .glass-card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 2rem;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
    }

    .glass-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 184, 0, 0.1), transparent);
        transition: left 0.6s ease;
    }

    .glass-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--shadow-glow);
        border-color: var(--primary-gold);
    }

    .glass-card:hover::before {
        left: 100%;
    }

    /* User header */
    .user-header {
        background: linear-gradient(135deg, var(--primary-teal-dark), var(--primary-teal));
        border-radius: 25px;
        padding: 2.5rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }

    .user-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            radial-gradient(circle at 20% 80%, rgba(255, 184, 0, 0.2) 0%, transparent 50%),
            radial-gradient(circle at 80% 20%, rgba(255, 184, 0, 0.1) 0%, transparent 50%);
        z-index: 1;
    }

    .user-header-content {
        position: relative;
        z-index: 2;
    }

    .user-avatar {
        width: 80px;
        height: 80px;
        border: 4px solid var(--primary-gold);
        border-radius: 50%;
        filter: drop-shadow(0 0 20px rgba(255, 184, 0, 0.5));
        transition: all 0.3s ease;
    }

    .user-avatar:hover {
        transform: scale(1.05);
        filter: drop-shadow(0 0 25px rgba(255, 184, 0, 0.8));
    }

    /* Stat cards */
    .stat-card {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 2rem;
        text-align: center;
        transition: all 0.4s ease;
        position: relative;
        overflow: hidden;
        height: 100%;
    }

    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, var(--primary-gold), var(--primary-teal));
    }

    .stat-card:hover {
        transform: translateY(-8px) scale(1.02);
        box-shadow: var(--shadow-glow);
        border-color: var(--primary-gold);
    }

    .stat-icon {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, var(--primary-gold), var(--primary-gold-dark));
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
        font-size: 1.5rem;
        color: var(--dark-bg);
        transition: all 0.3s ease;
    }

    .stat-card:hover .stat-icon {
        transform: scale(1.1) rotate(5deg);
    }

    .stat-value {
        font-size: 2.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, var(--primary-gold), var(--primary-gold-light));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 0.5rem;
    }

    .stat-label {
        color: var(--text-secondary);
        font-weight: 500;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.85rem;
    }

    /* Rank card */
    .rank-card {
        background: linear-gradient(135deg, var(--primary-gold), var(--primary-gold-dark));
        color: var(--dark-bg);
        border-radius: 25px;
        padding: 2rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }

    .rank-emoji {
        font-size: 4rem;
        text-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        animation: float 3s ease-in-out infinite;
    }

    /* Status badge */
    .status-badge {
        padding: 0.75rem 1.5rem;
        border-radius: 25px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s ease;
    }

    .status-badge.online {
        background: linear-gradient(135deg, #00ff88, #00cc6a);
        color: var(--dark-bg);
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
    }

    .status-badge.offline {
        background: var(--dark-surface);
        color: var(--text-secondary);
        border: 1px solid var(--glass-border);
    }

    .status-indicator {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        animation: pulse 2s infinite;
    }

    .status-indicator.online {
        background: #00ff88;
    }

    .status-indicator.offline {
        background: var(--text-muted);
    }

    @keyframes pulse {
        0% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.7; transform: scale(1.1); }
        100% { opacity: 1; transform: scale(1); }
    }

    /* Action buttons */
    .action-btn {
        background: var(--glass-bg);
        border: 1px solid var(--glass-border);
        color: var(--text-primary);
        padding: 1rem;
        border-radius: 15px;
        text-decoration: none;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
        transition: all 0.3s ease;
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
    }

    .action-btn:hover {
        background: var(--primary-gold);
        color: var(--dark-bg);
        transform: translateY(-3px);
        box-shadow: var(--shadow-glow);
        border-color: var(--primary-gold);
    }

    .action-btn i {
        font-size: 1.5rem;
    }

    /* Chart container */
    .chart-container {
        background: var(--glass-bg);
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
    }

    /* Info list */
    .info-list {
        list-style: none;
        padding: 0;
    }

    .info-list li {
        padding: 0.75rem 0;
        border-bottom: 1px solid var(--glass-border);
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .info-list li:last-child {
        border-bottom: none;
    }

    .info-label {
        color: var(--text-secondary);
        font-weight: 500;
    }

    .info-value {
        color: var(--text-primary);
        font-weight: 600;
    }

    /* Warning alert for non-registered users */
    .registration-alert {
        background: linear-gradient(135deg, var(--accent-orange), #ff4757);
        color: white;
        border-radius: 20px;
        padding: 2.5rem;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }

    .registration-alert::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            radial-gradient(circle at 30% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
        z-index: 1;
    }

    .registration-alert-content {
        position: relative;
        z-index: 2;
    }

    /* Modal styling */
    .modal-content {
        background: var(--dark-card);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        backdrop-filter: blur(20px);
        -webkit-backdrop-filter: blur(20px);
    }

    .modal-header {
        border-bottom: 1px solid var(--glass-border);
    }

    .modal-footer {
        border-top: 1px solid var(--glass-border);
    }

    /* Responsive design */
    @media (max-width: 768px) {
        .user-header {
            padding: 2rem;
            text-align: center;
        }
        
        .stat-card {
            margin-bottom: 1rem;
        }
        
        .glass-card {
            padding: 1.5rem;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- User Header -->
    <div class="user-header">
        <div class="user-header-content">
            <div class="row align-items-center">
                <div class="col-auto">
                    <img src="{{ avatar_url }}" alt="Avatar" class="user-avatar">
                </div>
                <div class="col">
                    <h1 class="h2 mb-1 text-white">Olá, {{ user.username }}!</h1>
                    <p class="mb-0" style="color: rgba(255, 255, 255, 0.8);">
                        <i class="bi bi-shield-check me-1"></i>
                        Bem-vindo ao seu dashboard do Sistema Guardião BETA
                    </p>
                </div>
                <div class="col-auto">
                    <img src="{{ url_for('static', filename='img/logoguardiao.png') }}" 
                         alt="Logo" width="60" height="60" 
                         style="filter: drop-shadow(0 0 15px rgba(255, 255, 255, 0.3));">
                </div>
            </div>
        </div>
    </div>

    {% if not cadastrado %}
        <!-- Registration Alert -->
        <div class="registration-alert">
            <div class="registration-alert-content">
                <div class="row align-items-center">
                    <div class="col-auto">
                        <i class="bi bi-exclamation-triangle" style="font-size: 3rem;"></i>
                    </div>
                    <div class="col">
                        <h4 class="mb-2">Cadastro Necessário</h4>
                        <p class="mb-3">
                            Você ainda não está cadastrado no Sistema Guardião BETA. 
                            Complete seu cadastro para usar todas as funcionalidades avançadas.
                        </p>
                        <div class="d-flex gap-3">
                            <div>
                                <strong>Como se cadastrar:</strong><br>
                                1. Abra o Discord<br>
                                2. Use o comando <code style="background: rgba(255,255,255,0.2); color: white; padding: 0.25rem 0.5rem; border-radius: 4px;">/cadastro</code><br>
                                3. Preencha o formulário
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    {% else %}
        <!-- Rank Display -->
        <div class="rank-card">
            <div class="row align-items-center">
                <div class="col-auto">
                    <div class="rank-emoji">{{ emoji }}</div>
                </div>
                <div class="col">
                    <h3 class="mb-1">{{ rank }}</h3>
                    <p class="mb-0 opacity-75">{{ experience_display }}</p>
                </div>
                <div class="col-auto">
                    <div class="status-badge {{ 'online' if db_user.em_servico else 'offline' }}">
                        <div class="status-indicator {{ 'online' if db_user.em_servico else 'offline' }}"></div>
                        {{ 'Em Serviço' if db_user.em_servico else 'Fora de Serviço' }}
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Stats Grid -->
        <div class="row g-4 mb-4">
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="bi bi-shield-check"></i>
                    </div>
                    <div class="stat-value">{{ db_user.categoria }}</div>
                    <div class="stat-label">Categoria</div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="bi bi-star-fill"></i>
                    </div>
                    <div class="stat-value">{{ db_user.experiencia }}</div>
                    <div class="stat-label">Experiência</div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="bi bi-trophy-fill"></i>
                    </div>
                    <div class="stat-value">{{ db_user.pontos }}</div>
                    <div class="stat-label">Pontos</div>
                </div>
            </div>
            
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="bi bi-clock-fill"></i>
                    </div>
                    <div class="stat-value" style="font-size: 1.5rem;">{{ ultima_atividade }}</div>
                    <div class="stat-label">Última Atividade</div>
                </div>
            </div>
        </div>

        <!-- Activity Stats -->
        <div class="row g-4 mb-4">
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--primary-teal), var(--primary-teal-light));">
                        <i class="bi bi-flag-fill"></i>
                    </div>
                    <div class="stat-value">{{ stats.denuncias_atendidas or 0 }}</div>
                    <div class="stat-label">Denúncias Atendidas</div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, #00ff88, #00cc6a);">
                        <i class="bi bi-check-circle-fill"></i>
                    </div>
                    <div class="stat-value">{{ stats.total_votos or 0 }}</div>
                    <div class="stat-label">Total de Votos</div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="stat-card">
                    <div class="stat-icon" style="background: linear-gradient(135deg, var(--accent-orange), #ff4757);">
                        <i class="bi bi-send-fill"></i>
                    </div>
                    <div class="stat-value">{{ stats.denuncias_feitas or 0 }}</div>
                    <div class="stat-label">Denúncias Feitas</div>
                </div>
            </div>
        </div>

        <!-- Main Content Grid -->
        <div class="row g-4 mb-4">
            <!-- Service Control -->
            <div class="col-lg-6">
                <div class="glass-card">
                    <h5 class="mb-4" style="color: var(--text-primary);">
                        <i class="bi bi-power me-2"></i> Controle de Serviço
                    </h5>
                    
                    {% if db_user.categoria in ['Guardião', 'Moderador', 'Administrador'] %}
                        <div class="d-grid">
                            <button class="btn btn-custom-primary btn-lg" onclick="toggleService()">
                                <i class="bi bi-{{ 'pause-circle' if db_user.em_servico else 'play-circle' }} me-2"></i>
                                {{ 'Sair de Serviço' if db_user.em_servico else 'Entrar em Serviço' }}
                            </button>
                        </div>
                        <p class="mt-3 mb-0" style="color: var(--text-secondary); text-align: center;">
                            <small>
                                <i class="bi bi-info-circle me-1"></i>
                                {{ 'Você está recebendo denúncias para análise' if db_user.em_servico else 'Ative o serviço para receber denúncias' }}
                            </small>
                        </p>
                    {% else %}
                        <div class="text-center">
                            <div class="mb-3">
                                <i class="bi bi-shield-exclamation" style="font-size: 3rem; color: var(--text-muted);"></i>
                            </div>
                            <p style="color: var(--text-secondary);">
                                Para entrar em serviço, você precisa ser um Guardião.
                            </p>
                            <code style="background: var(--dark-card); color: var(--primary-gold); padding: 0.5rem 1rem; border-radius: 8px;">
                                /formguardiao
                            </code>
                        </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Personal Info -->
            <div class="col-lg-6">
                <div class="glass-card">
                    <h5 class="mb-4" style="color: var(--text-primary);">
                        <i class="bi bi-person-fill me-2"></i> Informações Pessoais
                    </h5>
                    <ul class="info-list">
                        <li>
                            <span class="info-label">Nome:</span>
                            <span class="info-value">{{ db_user.nome_completo }}</span>
                        </li>
                        <li>
                            <span class="info-label">Idade:</span>
                            <span class="info-value">{{ db_user.idade }} anos</span>
                        </li>
                        <li>
                            <span class="info-label">Email:</span>
                            <span class="info-value">{{ db_user.email }}</span>
                        </li>
                        <li>
                            <span class="info-label">Telefone:</span>
                            <span class="info-value">{{ db_user.telefone }}</span>
                        </li>
                        <li>
                            <span class="info-label">Membro desde:</span>
                            <span class="info-value">{{ db_user.data_criacao_registro.strftime('%d/%m/%Y') if db_user.data_criacao_registro else 'N/A' }}</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Activity Chart -->
        <div class="chart-container">
            <h5 class="mb-4" style="color: var(--text-primary);">
                <i class="bi bi-graph-up me-2"></i> Atividade dos Últimos 30 Dias
            </h5>
            <div style="position: relative; height: 300px;">
                <canvas id="activityChart"></canvas>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="glass-card">
            <h5 class="mb-4" style="color: var(--text-primary);">
                <i class="bi bi-lightning-fill me-2"></i> Ações Rápidas
            </h5>
            <div class="row g-3">
                <div class="col-lg-3 col-md-6">
                    <a href="{{ url_for('servers') }}" class="action-btn">
                        <i class="bi bi-server"></i>
                        <span>Meus Servidores</span>
                    </a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <a href="{{ url_for('premium') }}" class="action-btn">
                        <i class="bi bi-star-fill"></i>
                        <span>Premium</span>
                    </a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <a href="#" class="action-btn" onclick="refreshStats()">
                        <i class="bi bi-arrow-clockwise"></i>
                        <span>Atualizar</span>
                    </a>
                </div>
                <div class="col-lg-3 col-md-6">
                    <a href="#" class="action-btn" onclick="showHelp()">
                        <i class="bi bi-question-circle-fill"></i>
                        <span>Ajuda</span>
                    </a>
                </div>
            </div>
        </div>
    {% endif %}
</div>

<!-- Service Toggle Modal -->
<div class="modal fade" id="serviceModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" style="color: var(--text-primary);">
                    <i class="bi bi-power me-2"></i> Alterar Status de Serviço
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body" style="color: var(--text-secondary);">
                <div class="text-center mb-4">
                    <i class="bi bi-question-circle" style="font-size: 3rem; color: var(--primary-gold);"></i>
                </div>
                <p class="text-center">Tem certeza que deseja alterar seu status de serviço?</p>
                <div class="alert" style="background: var(--glass-bg); border: 1px solid var(--primary-gold); color: var(--text-primary);">
                    <i class="bi bi-info-circle me-2"></i>
                    <strong>Lembrete:</strong> Guardiões em serviço recebem denúncias para análise e ganham experiência.
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-custom-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-custom-primary" onclick="confirmServiceToggle()">
                    <i class="bi bi-check-circle me-1"></i> Confirmar
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
// Enhanced Activity Chart with modern styling
document.addEventListener('DOMContentLoaded', function() {
    const ctx = document.getElementById('activityChart');
    if (ctx) {
        // Create gradient
        const gradient = ctx.getContext('2d').createLinearGradient(0, 0, 0, 300);
        gradient.addColorStop(0, 'rgba(255, 184, 0, 0.3)');
        gradient.addColorStop(1, 'rgba(255, 184, 0, 0.05)');
        
        // Fetch user stats
        fetch('/api/user/stats')
            .then(response => response.json())
            .then(data => {
                const activityData = data.activity || [];
                
                // Prepare chart data
                const labels = [];
                const votes = [];
                
                // Generate last 30 days
                for (let i = 29; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(date.getDate() - i);
                    labels.push(date.toLocaleDateString('pt-BR', { day: '2-digit', month: '2-digit' }));
                    
                    // Find votes for this date
                    const dayVotes = activityData.find(item => 
                        new Date(item.data).toDateString() === date.toDateString()
                    );
                    votes.push(dayVotes ? dayVotes.votos : 0);
                }
                
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Votos por Dia',
                            data: votes,
                            borderColor: '#FFB800',
                            backgroundColor: gradient,
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#FFB800',
                            pointBorderColor: '#FFD700',
                            pointBorderWidth: 2,
                            pointRadius: 5,
                            pointHoverRadius: 8
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                backgroundColor: 'rgba(26, 31, 46, 0.9)',
                                titleColor: '#FFB800',
                                bodyColor: '#FFFFFF',
                                borderColor: '#FFB800',
                                borderWidth: 1
                            }
                        },
                        scales: {
                            x: {
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)',
                                    drawBorder: false
                                },
                                ticks: {
                                    color: '#B8BCC8'
                                }
                            },
                            y: {
                                beginAtZero: true,
                                grid: {
                                    color: 'rgba(255, 255, 255, 0.1)',
                                    drawBorder: false
                                },
                                ticks: {
                                    stepSize: 1,
                                    color: '#B8BCC8'
                                }
                            }
                        }
                    }
                });
            })
            .catch(error => {
                console.error('Erro ao carregar estatísticas:', error);
                // Show error message in chart area
                ctx.getContext('2d').fillStyle = '#6C7293';
                ctx.getContext('2d').font = '16px Inter';
                ctx.getContext('2d').textAlign = 'center';
                ctx.getContext('2d').fillText('Erro ao carregar dados', ctx.width/2, ctx.height/2);
            });
    }
});

// Service toggle functions with enhanced UX
function toggleService() {
    const modal = new bootstrap.Modal(document.getElementById('serviceModal'));
    modal.show();
}

function confirmServiceToggle() {
    // Show loading state
    const confirmBtn = document.querySelector('#serviceModal .btn-custom-primary');
    const originalText = confirmBtn.innerHTML;
    confirmBtn.innerHTML = '<div class="spinner-border spinner-border-sm me-2"></div>Processando...';
    confirmBtn.disabled = true;
    
    // Simulate API call
    setTimeout(() => {
        alert('Funcionalidade em desenvolvimento. Use o comando /turno no Discord.');
        confirmBtn.innerHTML = originalText;
        confirmBtn.disabled = false;
        bootstrap.Modal.getInstance(document.getElementById('serviceModal')).hide();
    }, 1500);
}

// Enhanced refresh with loading state
function refreshStats() {
    // Add loading overlay
    const overlay = document.createElement('div');
    overlay.innerHTML = `
        <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
                    background: rgba(10, 15, 28, 0.8); z-index: 9999; 
                    display: flex; align-items: center; justify-content: center;">
            <div style="text-align: center; color: white;">
                <div class="spinner-border text-warning mb-3"></div>
                <div>Atualizando dados...</div>
            </div>
        </div>
    `;
    document.body.appendChild(overlay);
    
    setTimeout(() => {
        location.reload();
    }, 1000);
}

function showHelp() {
    // Create modern help modal
    const helpModal = document.createElement('div');
    helpModal.innerHTML = `
        <div class="modal fade" id="helpModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" style="color: var(--text-primary);">
                            <i class="bi bi-question-circle me-2"></i> Ajuda do Sistema
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body" style="color: var(--text-secondary);">
                        <div class="text-center mb-4">
                            <img src="${document.querySelector('img[alt="Logo"]').src}" width="80" height="80" style="filter: drop-shadow(0 0 15px rgba(255, 184, 0, 0.5));">
                        </div>
                        <h6 style="color: var(--primary-gold);">Comandos Principais:</h6>
                        <ul>
                            <li><code>/cadastro</code> - Completar cadastro</li>
                            <li><code>/formguardiao</code> - Tornar-se Guardião</li>
                            <li><code>/turno</code> - Entrar/sair de serviço</li>
                            <li><code>/report</code> - Fazer denúncia</li>
                        </ul>
                        <hr style="border-color: var(--glass-border);">
                        <p class="mb-0">Para suporte adicional, entre em contato através do Discord oficial.</p>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-custom-primary" data-bs-dismiss="modal">Entendi</button>
                    </div>
                </div>
            </div>
        </div>
    `;
    document.body.appendChild(helpModal);
    
    const modal = new bootstrap.Modal(document.getElementById('helpModal'));
    modal.show();
    
    // Remove modal from DOM when hidden
    document.getElementById('helpModal').addEventListener('hidden.bs.modal', function() {
        document.body.removeChild(helpModal);
    });
}

// Add scroll animations
const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
        }
    });
}, { threshold: 0.1 });

// Initialize animations
document.addEventListener('DOMContentLoaded', function() {
    const animatedElements = document.querySelectorAll('.stat-card, .glass-card, .chart-container');
    animatedElements.forEach(element => {
        element.style.opacity = '0';
        element.style.transform = 'translateY(30px)';
        element.style.transition = 'all 0.6s ease';
        observer.observe(element);
    });
});
</script>
{% endblock %}